<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    
    <link rel="shortcut icon" href="../../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Plotter Tools - helpohelpo</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Module helpers.plotter_tools", url: "#_top", children: [
              {title: "Functions", url: "#functions" },
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../string_tools/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../string_tools/" class="btn btn-xs btn-link">
        String Tools
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../os_functions/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../os_functions/" class="btn btn-xs btn-link">
        Os Functions
      </a>
    </div>
    
  </div>

    

    <h1 id="module-helpersplotter_tools">Module helpers.plotter_tools</h1>
<p>Functions to assist in plotting images.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="sd">&quot;&quot;&quot;Functions to assist in plotting images.&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">os</span> <span class="kn">as</span> <span class="nn">os</span>

<span class="kn">import</span> <span class="nn">subprocess</span>

<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>

<span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">itemgetter</span>

<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">zip_longest</span><span class="p">,</span> <span class="n">groupby</span>

<span class="kn">import</span> <span class="nn">matplotlib</span>

<span class="n">matplotlib</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;agg&quot;</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">matplotlib.patheffects</span> <span class="kn">as</span> <span class="nn">pe</span>

<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">rcParams</span>

<span class="kn">from</span> <span class="nn">pylab</span> <span class="kn">import</span> <span class="n">figure</span>

<span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;axes.labelsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">14</span>

<span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;xtick.labelsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">14</span>

<span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;ytick.labelsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">14</span>

<span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;legend.fontsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">12</span>

<span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;font.family&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Dejavu Sans&quot;</span>

<span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;font.serif&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Computer Modern Roman&quot;</span><span class="p">]</span>

<span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;xtick.major.pad&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">12</span>

<span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;ytick.major.pad&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">12</span>

<span class="k">def</span> <span class="nf">image_pager</span><span class="p">(</span><span class="n">img_list</span><span class="p">,</span> <span class="n">horiz_n</span><span class="p">,</span> <span class="n">vert_n</span><span class="p">,</span> <span class="n">path_str</span><span class="p">,</span> <span class="n">fin_prefix</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Concats a list of images into an NxN page using imagemagick .&quot;&quot;&quot;</span>

    <span class="n">horiz_paste</span> <span class="o">=</span> <span class="n">grouper</span><span class="p">(</span><span class="n">img_list</span><span class="p">,</span> <span class="n">horiz_n</span><span class="p">)</span>

    <span class="n">vert_img_li</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">horiz_paste</span><span class="p">):</span>

        <span class="n">img_name_li</span> <span class="o">=</span> <span class="p">[</span>

            <span class="n">path_str</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">img_name</span> <span class="k">for</span> <span class="n">img_name</span> <span class="ow">in</span> <span class="n">row</span> <span class="k">if</span> <span class="n">img_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span>

        <span class="p">]</span>

        <span class="n">out_img_name</span> <span class="o">=</span> <span class="n">path_str</span> <span class="o">+</span> <span class="s2">&quot;/row_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.png&quot;</span>

        <span class="n">concat_images</span><span class="p">(</span><span class="n">file_li</span><span class="o">=</span><span class="n">img_name_li</span><span class="p">,</span> <span class="n">outname</span><span class="o">=</span><span class="n">out_img_name</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;horiz&quot;</span><span class="p">)</span>

        <span class="n">vert_img_li</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">out_img_name</span><span class="p">)</span>

    <span class="c1">###</span>

    <span class="n">vert_paste</span> <span class="o">=</span> <span class="n">grouper</span><span class="p">(</span><span class="n">vert_img_li</span><span class="p">,</span> <span class="n">vert_n</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">vert_paste</span><span class="p">):</span>

        <span class="n">img_name_li</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">col</span> <span class="k">if</span> <span class="n">row</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">]</span>

        <span class="n">out_img_name</span> <span class="o">=</span> <span class="n">path_str</span> <span class="o">+</span> <span class="n">fin_prefix</span> <span class="o">+</span> <span class="s2">&quot;_page_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.png&quot;</span>

        <span class="n">concat_images</span><span class="p">(</span><span class="n">file_li</span><span class="o">=</span><span class="n">img_name_li</span><span class="p">,</span> <span class="n">outname</span><span class="o">=</span><span class="n">out_img_name</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;vert&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="bp">None</span>

<span class="k">def</span> <span class="nf">grouper</span><span class="p">(</span><span class="n">mylist</span><span class="p">,</span> <span class="n">subli_size</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Collect data into fixed-length chunks or blocks</span>

<span class="sd">    grouper(&#39;ABCDEFG&#39;, 3, &#39;x&#39;) --&gt; ABC DEF Gxx&quot;&quot;&quot;</span>

    <span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="nb">iter</span><span class="p">(</span><span class="n">mylist</span><span class="p">)]</span> <span class="o">*</span> <span class="n">subli_size</span>

    <span class="k">return</span> <span class="n">zip_longest</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">fillvalue</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">concat_images</span><span class="p">(</span><span class="n">file_li</span><span class="p">,</span> <span class="n">outname</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;horiz&quot;</span><span class="p">,</span> <span class="n">del_input</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Pastes inages into horizontal rows or vertical columns.&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;horiz&quot;</span><span class="p">:</span>

        <span class="n">append</span> <span class="o">=</span> <span class="s2">&quot;+append&quot;</span>

    <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;vert&quot;</span><span class="p">:</span>

        <span class="n">append</span> <span class="o">=</span> <span class="s2">&quot;-append&quot;</span>

    <span class="n">formated_cmd</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;convert&quot;</span><span class="p">,</span> <span class="n">append</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">file_name</span> <span class="ow">in</span> <span class="n">file_li</span><span class="p">:</span>

        <span class="n">formated_cmd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>

    <span class="n">formated_cmd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">outname</span><span class="p">)</span>

    <span class="n">subprocess</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">formated_cmd</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">del_input</span><span class="p">:</span>

        <span class="k">for</span> <span class="n">file_name</span> <span class="ow">in</span> <span class="n">file_li</span><span class="p">:</span>

            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>

    <span class="k">return</span>

<span class="k">def</span> <span class="nf">nested_line_plot</span><span class="p">(</span>

    <span class="n">x_data</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>

    <span class="n">y_data</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>

    <span class="n">ls_var</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span>

    <span class="n">col_var</span><span class="o">=</span><span class="s2">&quot;RAND&quot;</span><span class="p">,</span>

    <span class="n">lw_var</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>

    <span class="n">alpha1_var</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>

    <span class="n">title_var</span><span class="o">=</span><span class="s2">&quot;null&quot;</span><span class="p">,</span>

    <span class="n">fig_name</span><span class="o">=</span><span class="s2">&quot;null.png&quot;</span><span class="p">,</span>

    <span class="n">ylim_var</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>

    <span class="n">xlim_var</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>

    <span class="n">main_label</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>

    <span class="o">**</span><span class="n">kwargs</span>

<span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">       Multi-line function call. kwargs are dictionaries.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">figure</span><span class="p">()</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title_var</span><span class="p">)</span>

    <span class="n">axhell</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">axhell</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>

    <span class="n">axhell</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title_var</span><span class="p">)</span>

    <span class="n">axhell</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">ylim_var</span><span class="p">:</span>

        <span class="n">axhell</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim_var</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">xlim_var</span><span class="p">:</span>

        <span class="n">axhell</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">x_data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">col_var</span> <span class="o">==</span> <span class="s2">&quot;RAND&quot;</span><span class="p">:</span>

        <span class="n">axhell</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>

            <span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="n">ls_var</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">lw_var</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha1_var</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">main_label</span>

        <span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>

        <span class="n">axhell</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>

            <span class="n">x_data</span><span class="p">,</span>

            <span class="n">y_data</span><span class="p">,</span>

            <span class="n">ls</span><span class="o">=</span><span class="n">ls_var</span><span class="p">,</span>

            <span class="n">color</span><span class="o">=</span><span class="n">col_var</span><span class="p">,</span>

            <span class="n">lw</span><span class="o">=</span><span class="n">lw_var</span><span class="p">,</span>

            <span class="n">alpha</span><span class="o">=</span><span class="n">alpha1_var</span><span class="p">,</span>

            <span class="n">label</span><span class="o">=</span><span class="n">main_label</span><span class="p">,</span>

        <span class="p">)</span>

    <span class="c1"># print additional lines if present</span>

    <span class="k">if</span> <span class="n">kwargs</span><span class="p">:</span>

        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

            <span class="n">aux_plot</span> <span class="o">=</span> <span class="p">{</span>

                <span class="s2">&quot;xdat&quot;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>

                <span class="s2">&quot;ydat&quot;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>

                <span class="s2">&quot;ls&quot;</span><span class="p">:</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span>

                <span class="s2">&quot;col&quot;</span><span class="p">:</span> <span class="s2">&quot;k&quot;</span><span class="p">,</span>

                <span class="s2">&quot;lw&quot;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span>

                <span class="s2">&quot;alph&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>

                <span class="s2">&quot;aux_lab&quot;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>

                <span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="s2">&quot;line&quot;</span><span class="p">,</span>

            <span class="p">}</span>

            <span class="k">for</span> <span class="n">subkey</span><span class="p">,</span> <span class="n">subval</span> <span class="ow">in</span> <span class="n">value</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

                <span class="n">aux_plot</span><span class="p">[</span><span class="n">subkey</span><span class="p">]</span> <span class="o">=</span> <span class="n">subval</span>

            <span class="k">if</span> <span class="n">aux_plot</span><span class="p">[</span><span class="s2">&quot;mode&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;line&quot;</span><span class="p">:</span>

                <span class="n">axhell</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>

                    <span class="n">aux_plot</span><span class="p">[</span><span class="s2">&quot;xdat&quot;</span><span class="p">],</span>

                    <span class="n">aux_plot</span><span class="p">[</span><span class="s2">&quot;ydat&quot;</span><span class="p">],</span>

                    <span class="n">ls</span><span class="o">=</span><span class="n">aux_plot</span><span class="p">[</span><span class="s2">&quot;ls&quot;</span><span class="p">],</span>

                    <span class="n">color</span><span class="o">=</span><span class="n">aux_plot</span><span class="p">[</span><span class="s2">&quot;col&quot;</span><span class="p">],</span>

                    <span class="n">lw</span><span class="o">=</span><span class="n">aux_plot</span><span class="p">[</span><span class="s2">&quot;lw&quot;</span><span class="p">],</span>

                    <span class="n">alpha</span><span class="o">=</span><span class="n">aux_plot</span><span class="p">[</span><span class="s2">&quot;alph&quot;</span><span class="p">],</span>

                    <span class="n">label</span><span class="o">=</span><span class="n">aux_plot</span><span class="p">[</span><span class="s2">&quot;aux_lab&quot;</span><span class="p">],</span>

                <span class="p">)</span>

            <span class="k">elif</span> <span class="n">aux_plot</span><span class="p">[</span><span class="s2">&quot;mode&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;scatter&quot;</span><span class="p">:</span>

                <span class="n">axhell</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>

                    <span class="n">aux_plot</span><span class="p">[</span><span class="s2">&quot;xdat&quot;</span><span class="p">],</span>

                    <span class="n">aux_plot</span><span class="p">[</span><span class="s2">&quot;ydat&quot;</span><span class="p">],</span>

                    <span class="n">marker</span><span class="o">=</span><span class="n">aux_plot</span><span class="p">[</span><span class="s2">&quot;ls&quot;</span><span class="p">],</span>

                    <span class="n">color</span><span class="o">=</span><span class="n">aux_plot</span><span class="p">[</span><span class="s2">&quot;col&quot;</span><span class="p">],</span>

                    <span class="n">s</span><span class="o">=</span><span class="n">aux_plot</span><span class="p">[</span><span class="s2">&quot;lw&quot;</span><span class="p">],</span>

                    <span class="n">alpha</span><span class="o">=</span><span class="n">aux_plot</span><span class="p">[</span><span class="s2">&quot;alph&quot;</span><span class="p">],</span>

                <span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>

                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Extra line plotting mode not found&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">main_label</span><span class="p">:</span>

        <span class="n">axhell</span><span class="o">.</span><span class="n">set_leg</span> <span class="o">=</span> <span class="n">axhell</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">,</span> <span class="n">fancybox</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="n">axhell</span><span class="o">.</span><span class="n">set_leg</span><span class="o">.</span><span class="n">get_frame</span><span class="p">()</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">w_pad</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">h_pad</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fig_name</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

    <span class="k">return</span>

<span class="k">def</span> <span class="nf">list_duplicates</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Uses default dict to find index numbers of repeated</span>

<span class="sd">       elements in a sequence.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">tally</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span>

        <span class="n">tally</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">)]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">tally</span>

<span class="k">def</span> <span class="nf">split_list_on_missing_elem</span><span class="p">(</span><span class="n">in_list</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    in: [1, 2, 3, 4, 6, 7, 8, 9, 10]</span>

<span class="sd">    out: [[1, 2, 3, 4], [6, 7, 8, 9, 10]]</span>

<span class="sd">    https://stackoverflow.com/questions/3149440/python-splitting-list-based-on-missing-numbers-in-a-sequence</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">idx_holder</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">groupby</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="n">in_list</span><span class="p">),</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>

        <span class="n">subli</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">g</span><span class="p">))</span>

        <span class="n">idx_holder</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">subli</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">idx_holder</span>

<span class="k">def</span> <span class="nf">viz_anamoly_plot</span><span class="p">(</span>

    <span class="n">col_date</span><span class="p">,</span> <span class="n">residuals</span><span class="p">,</span> <span class="n">residual_mad</span><span class="p">,</span> <span class="n">norm_counts</span><span class="p">,</span> <span class="n">normc_median</span><span class="p">,</span> <span class="n">img_path</span><span class="p">,</span> <span class="n">myrigidity</span>

<span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Visualise the identified anomaly. Plots normalised counts and</span>

<span class="sd">       euclidian distances with anomaly highlighted in red.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># get indexes of anomalous points &amp; corresponding y-axis valuesA</span>

    <span class="n">anomalous_truth_mask</span> <span class="o">=</span> <span class="n">residuals</span><span class="p">[</span><span class="s2">&quot;trig_anom&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="n">anomalous_times</span> <span class="o">=</span> <span class="n">residuals</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="n">anomalous_nc_y</span> <span class="o">=</span> <span class="n">norm_counts</span><span class="p">[</span><span class="n">col_date</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="n">anomalous_ncres_y</span> <span class="o">=</span> <span class="n">residuals</span><span class="p">[</span><span class="n">col_date</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="c1"># print(&quot;\nanomalous_truth_mask:&quot;, anomalous_truth_mask)</span>

    <span class="c1"># print(&quot;\nanomalous_times:&quot;, anomalous_times)</span>

    <span class="c1"># print(&quot;\nanomalous_nc_y:&quot;, anomalous_nc_y)</span>

    <span class="c1"># print(&quot;\nanomalous_ncres_y:&quot;, anomalous_ncres_y)</span>

    <span class="c1"># print(&quot;\n&quot;)</span>

    <span class="c1"># split anomalus lists into nested lists - to plot properly</span>

    <span class="n">truth_idxes</span> <span class="o">=</span> <span class="n">list_duplicates</span><span class="p">(</span><span class="n">anomalous_truth_mask</span><span class="p">)</span>

    <span class="n">split_idxes</span> <span class="o">=</span> <span class="n">split_list_on_missing_elem</span><span class="p">(</span><span class="n">truth_idxes</span><span class="p">[</span><span class="s2">&quot;True&quot;</span><span class="p">])</span>

    <span class="c1"># plot figure</span>

    <span class="n">figx</span> <span class="o">=</span> <span class="n">figure</span><span class="p">()</span>

    <span class="n">ax1</span> <span class="o">=</span> <span class="n">figx</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Anomaly Standardised Counts&quot;</span><span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.75</span><span class="p">,</span> <span class="mf">1.75</span><span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Norm counts&quot;</span><span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>

    <span class="k">for</span> <span class="n">sub_list</span> <span class="ow">in</span> <span class="n">split_idxes</span><span class="p">:</span>

        <span class="n">anom_time_sub</span> <span class="o">=</span> <span class="p">[</span><span class="n">anomalous_times</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">sub_list</span><span class="p">]</span>

        <span class="n">anom_ncy_sub</span> <span class="o">=</span> <span class="p">[</span><span class="n">anomalous_nc_y</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">sub_list</span><span class="p">]</span>

        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>

            <span class="n">anom_time_sub</span><span class="p">,</span>

            <span class="n">anom_ncy_sub</span><span class="p">,</span>

            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orangered&quot;</span><span class="p">,</span>

            <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span>

            <span class="n">lw</span><span class="o">=</span><span class="mf">4.4</span><span class="p">,</span>

            <span class="n">path_effects</span><span class="o">=</span><span class="p">[</span><span class="n">pe</span><span class="o">.</span><span class="n">Stroke</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">4.6</span><span class="p">,</span> <span class="n">foreground</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">),</span> <span class="n">pe</span><span class="o">.</span><span class="n">Normal</span><span class="p">()],</span>

            <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>

        <span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>

        <span class="n">residuals</span><span class="p">[</span><span class="n">col_date</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>

        <span class="n">norm_counts</span><span class="p">[</span><span class="n">col_date</span><span class="p">],</span>

        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;chartreuse&quot;</span><span class="p">,</span>

        <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span>

        <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>

        <span class="n">path_effects</span><span class="o">=</span><span class="p">[</span><span class="n">pe</span><span class="o">.</span><span class="n">Stroke</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">foreground</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">),</span> <span class="n">pe</span><span class="o">.</span><span class="n">Normal</span><span class="p">()],</span>

        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Event&quot;</span><span class="p">,</span>

    <span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>

        <span class="n">residuals</span><span class="p">[</span><span class="n">col_date</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>

        <span class="n">normc_median</span><span class="p">[</span><span class="s2">&quot;median_of_cols&quot;</span><span class="p">],</span>

        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;dodgerblue&quot;</span><span class="p">,</span>

        <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span>

        <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>

        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Median&quot;</span><span class="p">,</span>

    <span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">set_leg</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">,</span> <span class="n">fancybox</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">set_leg</span><span class="o">.</span><span class="n">get_frame</span><span class="p">()</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>

    <span class="c1">###</span>

    <span class="n">ax2</span> <span class="o">=</span> <span class="n">figx</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Euclidian distances - myRig: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">myrigidity</span><span class="p">))</span>

    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>

    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>

    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Norm Abs counts&quot;</span><span class="p">)</span>

    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">sub_list</span> <span class="ow">in</span> <span class="n">split_idxes</span><span class="p">:</span>

        <span class="n">anom_time_sub</span> <span class="o">=</span> <span class="p">[</span><span class="n">anomalous_times</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">sub_list</span><span class="p">]</span>

        <span class="n">anom_ncresy_sub</span> <span class="o">=</span> <span class="p">[</span><span class="n">anomalous_ncres_y</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">sub_list</span><span class="p">]</span>

        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>

            <span class="n">anom_time_sub</span><span class="p">,</span>

            <span class="n">anom_ncresy_sub</span><span class="p">,</span>

            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orangered&quot;</span><span class="p">,</span>

            <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span>

            <span class="n">lw</span><span class="o">=</span><span class="mf">4.4</span><span class="p">,</span>

            <span class="n">path_effects</span><span class="o">=</span><span class="p">[</span><span class="n">pe</span><span class="o">.</span><span class="n">Stroke</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">4.6</span><span class="p">,</span> <span class="n">foreground</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">),</span> <span class="n">pe</span><span class="o">.</span><span class="n">Normal</span><span class="p">()],</span>

            <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>

        <span class="p">)</span>

    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>

        <span class="n">residuals</span><span class="p">[</span><span class="n">col_date</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>

        <span class="n">residuals</span><span class="p">[</span><span class="n">col_date</span><span class="p">],</span>

        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;chartreuse&quot;</span><span class="p">,</span>

        <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span>

        <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>

        <span class="n">path_effects</span><span class="o">=</span><span class="p">[</span><span class="n">pe</span><span class="o">.</span><span class="n">Stroke</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">foreground</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">),</span> <span class="n">pe</span><span class="o">.</span><span class="n">Normal</span><span class="p">()],</span>

        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Event residual&quot;</span><span class="p">,</span>

    <span class="p">)</span>

    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>

        <span class="n">residuals</span><span class="p">[</span><span class="n">col_date</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>

        <span class="n">residual_mad</span><span class="p">[</span><span class="s2">&quot;mad_of_myrig&quot;</span><span class="p">],</span>

        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;dodgerblue&quot;</span><span class="p">,</span>

        <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span>

        <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>

        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Residual median&quot;</span><span class="p">,</span>

    <span class="p">)</span>

    <span class="n">ax2</span><span class="o">.</span><span class="n">set_leg</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">,</span> <span class="n">fancybox</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="n">ax2</span><span class="o">.</span><span class="n">set_leg</span><span class="o">.</span><span class="n">get_frame</span><span class="p">()</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">myax</span> <span class="ow">in</span> <span class="n">figx</span><span class="o">.</span><span class="n">axes</span><span class="p">:</span>

        <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="n">myax</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">w_pad</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">h_pad</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">img_path</span> <span class="o">+</span> <span class="s2">&quot;anomalies_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">col_date</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.png&quot;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">figx</span><span class="p">)</span>

    <span class="k">return</span>

<span class="k">def</span> <span class="nf">plot_err_bar_graphs</span><span class="p">(</span><span class="n">graph_data_dic</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Plot bar graphs with error bars.&quot;&quot;&quot;</span>

    <span class="n">y_vals_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;median_li&quot;</span><span class="p">,</span> <span class="s2">&quot;mean_li&quot;</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">y_key</span> <span class="ow">in</span> <span class="n">y_vals_keys</span><span class="p">:</span>

        <span class="n">fig_name</span> <span class="o">=</span> <span class="n">y_key</span> <span class="o">+</span> <span class="s2">&quot;.png&quot;</span>

        <span class="n">title_var</span> <span class="o">=</span> <span class="n">y_key</span>

        <span class="n">y_vals</span> <span class="o">=</span> <span class="n">graph_data_dic</span><span class="p">[</span><span class="n">y_key</span><span class="p">]</span>

        <span class="n">x_pos</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_vals</span><span class="p">),</span> <span class="mi">1</span><span class="p">))</span>

        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">CC&quot;</span><span class="p">,</span> <span class="n">y_key</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">)</span>

        <span class="n">fig</span> <span class="o">=</span> <span class="n">figure</span><span class="p">()</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title_var</span><span class="p">)</span>

        <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>

        <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title_var</span><span class="p">)</span>

        <span class="c1"># ax1.axhline(y=2.0, color=&quot;grey&quot;, linestyle=&#39;dashed&#39;, lw=1.5)</span>

        <span class="n">ax1</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>

            <span class="n">x_pos</span><span class="p">,</span>

            <span class="n">y_vals</span><span class="p">,</span>

            <span class="n">width</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>

            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;g&quot;</span><span class="p">,</span>

            <span class="n">ecolor</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>

            <span class="n">yerr</span><span class="o">=</span><span class="n">graph_data_dic</span><span class="p">[</span><span class="s2">&quot;stddev_li&quot;</span><span class="p">],</span>

            <span class="n">tick_label</span><span class="o">=</span><span class="n">graph_data_dic</span><span class="p">[</span><span class="s2">&quot;fn_li&quot;</span><span class="p">],</span>

            <span class="n">capsize</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>

            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.55</span><span class="p">,</span>

        <span class="p">)</span>

        <span class="c1"># ax1.plot(x_axis, value)</span>

        <span class="c1"># xxxxxxxxxxxxxx</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">w_pad</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">h_pad</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>

        <span class="c1"># plt.show()</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fig_name</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</code></pre></div>


</details>
<h2 id="functions">Functions</h2>
<h3 id="concat_images">concat_images</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">concat_images</span><span class="p">(</span>
    <span class="n">file_li</span><span class="p">,</span>
    <span class="n">outname</span><span class="p">,</span>
    <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;horiz&#39;</span><span class="p">,</span>
    <span class="n">del_input</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</code></pre></div>


<p>Pastes inages into horizontal rows or vertical columns.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="n">def</span> <span class="n">concat_images</span><span class="p">(</span><span class="n">file_li</span><span class="p">,</span> <span class="n">outname</span><span class="p">,</span> <span class="k">mode</span><span class="o">=</span><span class="ss">&quot;horiz&quot;</span><span class="p">,</span> <span class="n">del_input</span><span class="o">=</span><span class="k">True</span><span class="p">):</span>

    <span class="ss">&quot;&quot;&quot;Pastes inages into horizontal rows or vertical columns.&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="k">mode</span> <span class="o">==</span> <span class="ss">&quot;horiz&quot;</span><span class="p">:</span>

        <span class="n">append</span> <span class="o">=</span> <span class="ss">&quot;+append&quot;</span>

    <span class="n">elif</span> <span class="k">mode</span> <span class="o">==</span> <span class="ss">&quot;vert&quot;</span><span class="p">:</span>

        <span class="n">append</span> <span class="o">=</span> <span class="ss">&quot;-append&quot;</span>

    <span class="n">formated_cmd</span> <span class="o">=</span> <span class="p">[</span><span class="ss">&quot;convert&quot;</span><span class="p">,</span> <span class="n">append</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">file_name</span> <span class="k">in</span> <span class="n">file_li</span><span class="p">:</span>

        <span class="n">formated_cmd</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>

    <span class="n">formated_cmd</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">outname</span><span class="p">)</span>

    <span class="n">subprocess</span><span class="p">.</span><span class="k">call</span><span class="p">(</span><span class="n">formated_cmd</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">del_input</span><span class="p">:</span>

        <span class="k">for</span> <span class="n">file_name</span> <span class="k">in</span> <span class="n">file_li</span><span class="p">:</span>

            <span class="n">os</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>

    <span class="k">return</span>
</code></pre></div>


</details>
<h3 id="grouper">grouper</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">grouper</span><span class="p">(</span>
    <span class="n">mylist</span><span class="p">,</span>
    <span class="n">subli_size</span>
<span class="p">)</span>
</code></pre></div>


<p>Collect data into fixed-length chunks or blocks
grouper('ABCDEFG', 3, 'x') --&gt; ABC DEF Gxx</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="n">def</span> <span class="n">grouper</span><span class="p">(</span><span class="n">mylist</span><span class="p">,</span> <span class="n">subli_size</span><span class="p">):</span>

    <span class="ss">&quot;&quot;&quot;Collect data into fixed-length chunks or blocks</span>

<span class="ss">    grouper(&#39;ABCDEFG&#39;, 3, &#39;x&#39;) --&gt; ABC DEF Gxx&quot;&quot;&quot;</span>

    <span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="n">iter</span><span class="p">(</span><span class="n">mylist</span><span class="p">)]</span> <span class="o">*</span> <span class="n">subli_size</span>

    <span class="k">return</span> <span class="n">zip_longest</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">fillvalue</span><span class="o">=</span><span class="k">None</span><span class="p">)</span>
</code></pre></div>


</details>
<h3 id="image_pager">image_pager</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">image_pager</span><span class="p">(</span>
    <span class="n">img_list</span><span class="p">,</span>
    <span class="n">horiz_n</span><span class="p">,</span>
    <span class="n">vert_n</span><span class="p">,</span>
    <span class="n">path_str</span><span class="p">,</span>
    <span class="n">fin_prefix</span>
<span class="p">)</span>
</code></pre></div>


<p>Concats a list of images into an NxN page using imagemagick .</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="n">def</span> <span class="n">image_pager</span><span class="p">(</span><span class="n">img_list</span><span class="p">,</span> <span class="n">horiz_n</span><span class="p">,</span> <span class="n">vert_n</span><span class="p">,</span> <span class="n">path_str</span><span class="p">,</span> <span class="n">fin_prefix</span><span class="p">):</span>

    <span class="ss">&quot;&quot;&quot;Concats a list of images into an NxN page using imagemagick .&quot;&quot;&quot;</span>

    <span class="n">horiz_paste</span> <span class="o">=</span> <span class="n">grouper</span><span class="p">(</span><span class="n">img_list</span><span class="p">,</span> <span class="n">horiz_n</span><span class="p">)</span>

    <span class="n">vert_img_li</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="k">row</span> <span class="k">in</span> <span class="n">enumerate</span><span class="p">(</span><span class="n">horiz_paste</span><span class="p">):</span>

        <span class="n">img_name_li</span> <span class="o">=</span> <span class="p">[</span>

            <span class="n">path_str</span> <span class="o">+</span> <span class="ss">&quot;/&quot;</span> <span class="o">+</span> <span class="n">img_name</span> <span class="k">for</span> <span class="n">img_name</span> <span class="k">in</span> <span class="k">row</span> <span class="k">if</span> <span class="n">img_name</span> <span class="k">is</span> <span class="k">not</span> <span class="k">None</span>

        <span class="p">]</span>

        <span class="n">out_img_name</span> <span class="o">=</span> <span class="n">path_str</span> <span class="o">+</span> <span class="ss">&quot;/row_&quot;</span> <span class="o">+</span> <span class="n">str</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span> <span class="o">+</span> <span class="ss">&quot;.png&quot;</span>

        <span class="n">concat_images</span><span class="p">(</span><span class="n">file_li</span><span class="o">=</span><span class="n">img_name_li</span><span class="p">,</span> <span class="n">outname</span><span class="o">=</span><span class="n">out_img_name</span><span class="p">,</span> <span class="k">mode</span><span class="o">=</span><span class="ss">&quot;horiz&quot;</span><span class="p">)</span>

        <span class="n">vert_img_li</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">out_img_name</span><span class="p">)</span>

    <span class="o">###</span>

    <span class="n">vert_paste</span> <span class="o">=</span> <span class="n">grouper</span><span class="p">(</span><span class="n">vert_img_li</span><span class="p">,</span> <span class="n">vert_n</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">col</span> <span class="k">in</span> <span class="n">enumerate</span><span class="p">(</span><span class="n">vert_paste</span><span class="p">):</span>

        <span class="n">img_name_li</span> <span class="o">=</span> <span class="p">[</span><span class="k">row</span> <span class="k">for</span> <span class="k">row</span> <span class="k">in</span> <span class="n">col</span> <span class="k">if</span> <span class="k">row</span> <span class="k">is</span> <span class="k">not</span> <span class="k">None</span><span class="p">]</span>

        <span class="n">out_img_name</span> <span class="o">=</span> <span class="n">path_str</span> <span class="o">+</span> <span class="n">fin_prefix</span> <span class="o">+</span> <span class="ss">&quot;_page_&quot;</span> <span class="o">+</span> <span class="n">str</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span> <span class="o">+</span> <span class="ss">&quot;.png&quot;</span>

        <span class="n">concat_images</span><span class="p">(</span><span class="n">file_li</span><span class="o">=</span><span class="n">img_name_li</span><span class="p">,</span> <span class="n">outname</span><span class="o">=</span><span class="n">out_img_name</span><span class="p">,</span> <span class="k">mode</span><span class="o">=</span><span class="ss">&quot;vert&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="k">None</span>
</code></pre></div>


</details>
<h3 id="list_duplicates">list_duplicates</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">list_duplicates</span><span class="p">(</span>
    <span class="n">seq</span>
<span class="p">)</span>
</code></pre></div>


<p>Uses default dict to find index numbers of repeated
elements in a sequence.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="n">def</span> <span class="n">list_duplicates</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span>

    <span class="ss">&quot;&quot;&quot;Uses default dict to find index numbers of repeated</span>

<span class="ss">       elements in a sequence.</span>

<span class="ss">    &quot;&quot;&quot;</span>

    <span class="n">tally</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="n">list</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">item</span> <span class="k">in</span> <span class="n">enumerate</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span>

        <span class="n">tally</span><span class="p">[</span><span class="n">str</span><span class="p">(</span><span class="n">item</span><span class="p">)].</span><span class="n">append</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">tally</span>
</code></pre></div>


</details>
<h3 id="nested_line_plot">nested_line_plot</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">nested_line_plot</span><span class="p">(</span>
    <span class="n">x_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">y_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">ls_var</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span>
    <span class="n">col_var</span><span class="o">=</span><span class="s1">&#39;RAND&#39;</span><span class="p">,</span>
    <span class="n">lw_var</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">alpha1_var</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">title_var</span><span class="o">=</span><span class="s1">&#39;null&#39;</span><span class="p">,</span>
    <span class="n">fig_name</span><span class="o">=</span><span class="s1">&#39;null.png&#39;</span><span class="p">,</span>
    <span class="n">ylim_var</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">xlim_var</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">main_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>


<p>Multi-line function call. kwargs are dictionaries.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="n">def</span><span class="w"> </span><span class="n">nested_line_plot</span><span class="p">(</span><span class="w"></span>

<span class="w">    </span><span class="n">x_data</span><span class="o">=</span><span class="k">None</span><span class="p">,</span><span class="w"></span>

<span class="w">    </span><span class="n">y_data</span><span class="o">=</span><span class="k">None</span><span class="p">,</span><span class="w"></span>

<span class="w">    </span><span class="n">ls_var</span><span class="o">=</span><span class="ss">&quot;--&quot;</span><span class="p">,</span><span class="w"></span>

<span class="w">    </span><span class="n">col_var</span><span class="o">=</span><span class="ss">&quot;RAND&quot;</span><span class="p">,</span><span class="w"></span>

<span class="w">    </span><span class="n">lw_var</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="w"></span>

<span class="w">    </span><span class="n">alpha1_var</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="w"></span>

<span class="w">    </span><span class="n">title_var</span><span class="o">=</span><span class="ss">&quot;null&quot;</span><span class="p">,</span><span class="w"></span>

<span class="w">    </span><span class="n">fig_name</span><span class="o">=</span><span class="ss">&quot;null.png&quot;</span><span class="p">,</span><span class="w"></span>

<span class="w">    </span><span class="n">ylim_var</span><span class="o">=</span><span class="k">False</span><span class="p">,</span><span class="w"></span>

<span class="w">    </span><span class="n">xlim_var</span><span class="o">=</span><span class="k">False</span><span class="p">,</span><span class="w"></span>

<span class="w">    </span><span class="n">main_label</span><span class="o">=</span><span class="k">None</span><span class="p">,</span><span class="w"></span>

<span class="w">    </span><span class="o">**</span><span class="n">kwargs</span><span class="w"></span>

<span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">    </span><span class="ss">&quot;&quot;&quot;</span>

<span class="ss">       Multi-line function call. kwargs are dictionaries.</span>

<span class="ss">    &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">    </span><span class="n">fig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">figure</span><span class="p">()</span><span class="w"></span>

<span class="w">    </span><span class="n">plt</span><span class="p">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="n">title_var</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">axhell</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">plt</span><span class="p">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">axhell</span><span class="p">.</span><span class="n">grid</span><span class="p">(</span><span class="k">True</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">axhell</span><span class="p">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title_var</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">axhell</span><span class="p">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="ss">&quot;grey&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">linestyle</span><span class="o">=</span><span class="ss">&quot;dashed&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nl">ylim_var</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="n">axhell</span><span class="p">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim_var</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nl">xlim_var</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="n">axhell</span><span class="p">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">x_data</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">x_data</span><span class="o">[</span><span class="n">-1</span><span class="o">]</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">col_var</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="ss">&quot;RAND&quot;</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="n">axhell</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="w"></span>

<span class="w">            </span><span class="n">x_data</span><span class="p">,</span><span class="w"> </span><span class="n">y_data</span><span class="p">,</span><span class="w"> </span><span class="n">ls</span><span class="o">=</span><span class="n">ls_var</span><span class="p">,</span><span class="w"> </span><span class="n">lw</span><span class="o">=</span><span class="n">lw_var</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha1_var</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="o">=</span><span class="n">main_label</span><span class="w"></span>

<span class="w">        </span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">else</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="n">axhell</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="w"></span>

<span class="w">            </span><span class="n">x_data</span><span class="p">,</span><span class="w"></span>

<span class="w">            </span><span class="n">y_data</span><span class="p">,</span><span class="w"></span>

<span class="w">            </span><span class="n">ls</span><span class="o">=</span><span class="n">ls_var</span><span class="p">,</span><span class="w"></span>

<span class="w">            </span><span class="n">color</span><span class="o">=</span><span class="n">col_var</span><span class="p">,</span><span class="w"></span>

<span class="w">            </span><span class="n">lw</span><span class="o">=</span><span class="n">lw_var</span><span class="p">,</span><span class="w"></span>

<span class="w">            </span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha1_var</span><span class="p">,</span><span class="w"></span>

<span class="w">            </span><span class="n">label</span><span class="o">=</span><span class="n">main_label</span><span class="p">,</span><span class="w"></span>

<span class="w">        </span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="k">print</span><span class="w"> </span><span class="n">additional</span><span class="w"> </span><span class="n">lines</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">present</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nl">kwargs</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="k">key</span><span class="p">,</span><span class="w"> </span><span class="k">value</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">kwargs</span><span class="p">.</span><span class="n">items</span><span class="p">()</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">aux_plot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{</span><span class="w"></span>

<span class="w">                </span><span class="ss">&quot;xdat&quot;</span><span class="err">:</span><span class="w"> </span><span class="k">None</span><span class="p">,</span><span class="w"></span>

<span class="w">                </span><span class="ss">&quot;ydat&quot;</span><span class="err">:</span><span class="w"> </span><span class="k">None</span><span class="p">,</span><span class="w"></span>

<span class="w">                </span><span class="ss">&quot;ls&quot;</span><span class="err">:</span><span class="w"> </span><span class="ss">&quot;-&quot;</span><span class="p">,</span><span class="w"></span>

<span class="w">                </span><span class="ss">&quot;col&quot;</span><span class="err">:</span><span class="w"> </span><span class="ss">&quot;k&quot;</span><span class="p">,</span><span class="w"></span>

<span class="w">                </span><span class="ss">&quot;lw&quot;</span><span class="err">:</span><span class="w"> </span><span class="mf">1.5</span><span class="p">,</span><span class="w"></span>

<span class="w">                </span><span class="ss">&quot;alph&quot;</span><span class="err">:</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"></span>

<span class="w">                </span><span class="ss">&quot;aux_lab&quot;</span><span class="err">:</span><span class="w"> </span><span class="k">None</span><span class="p">,</span><span class="w"></span>

<span class="w">                </span><span class="ss">&quot;mode&quot;</span><span class="err">:</span><span class="w"> </span><span class="ss">&quot;line&quot;</span><span class="p">,</span><span class="w"></span>

<span class="w">            </span><span class="err">}</span><span class="w"></span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">subkey</span><span class="p">,</span><span class="w"> </span><span class="n">subval</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">value</span><span class="p">.</span><span class="n">items</span><span class="p">()</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="n">aux_plot</span><span class="o">[</span><span class="n">subkey</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">subval</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">aux_plot</span><span class="o">[</span><span class="n">&quot;mode&quot;</span><span class="o">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="ss">&quot;line&quot;</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="n">axhell</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="w"></span>

<span class="w">                    </span><span class="n">aux_plot</span><span class="o">[</span><span class="n">&quot;xdat&quot;</span><span class="o">]</span><span class="p">,</span><span class="w"></span>

<span class="w">                    </span><span class="n">aux_plot</span><span class="o">[</span><span class="n">&quot;ydat&quot;</span><span class="o">]</span><span class="p">,</span><span class="w"></span>

<span class="w">                    </span><span class="n">ls</span><span class="o">=</span><span class="n">aux_plot</span><span class="o">[</span><span class="n">&quot;ls&quot;</span><span class="o">]</span><span class="p">,</span><span class="w"></span>

<span class="w">                    </span><span class="n">color</span><span class="o">=</span><span class="n">aux_plot</span><span class="o">[</span><span class="n">&quot;col&quot;</span><span class="o">]</span><span class="p">,</span><span class="w"></span>

<span class="w">                    </span><span class="n">lw</span><span class="o">=</span><span class="n">aux_plot</span><span class="o">[</span><span class="n">&quot;lw&quot;</span><span class="o">]</span><span class="p">,</span><span class="w"></span>

<span class="w">                    </span><span class="n">alpha</span><span class="o">=</span><span class="n">aux_plot</span><span class="o">[</span><span class="n">&quot;alph&quot;</span><span class="o">]</span><span class="p">,</span><span class="w"></span>

<span class="w">                    </span><span class="n">label</span><span class="o">=</span><span class="n">aux_plot</span><span class="o">[</span><span class="n">&quot;aux_lab&quot;</span><span class="o">]</span><span class="p">,</span><span class="w"></span>

<span class="w">                </span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="n">elif</span><span class="w"> </span><span class="n">aux_plot</span><span class="o">[</span><span class="n">&quot;mode&quot;</span><span class="o">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="ss">&quot;scatter&quot;</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="n">axhell</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span><span class="w"></span>

<span class="w">                    </span><span class="n">aux_plot</span><span class="o">[</span><span class="n">&quot;xdat&quot;</span><span class="o">]</span><span class="p">,</span><span class="w"></span>

<span class="w">                    </span><span class="n">aux_plot</span><span class="o">[</span><span class="n">&quot;ydat&quot;</span><span class="o">]</span><span class="p">,</span><span class="w"></span>

<span class="w">                    </span><span class="n">marker</span><span class="o">=</span><span class="n">aux_plot</span><span class="o">[</span><span class="n">&quot;ls&quot;</span><span class="o">]</span><span class="p">,</span><span class="w"></span>

<span class="w">                    </span><span class="n">color</span><span class="o">=</span><span class="n">aux_plot</span><span class="o">[</span><span class="n">&quot;col&quot;</span><span class="o">]</span><span class="p">,</span><span class="w"></span>

<span class="w">                    </span><span class="n">s</span><span class="o">=</span><span class="n">aux_plot</span><span class="o">[</span><span class="n">&quot;lw&quot;</span><span class="o">]</span><span class="p">,</span><span class="w"></span>

<span class="w">                    </span><span class="n">alpha</span><span class="o">=</span><span class="n">aux_plot</span><span class="o">[</span><span class="n">&quot;alph&quot;</span><span class="o">]</span><span class="p">,</span><span class="w"></span>

<span class="w">                </span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="k">else</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="n">raise</span><span class="w"> </span><span class="k">Exception</span><span class="p">(</span><span class="ss">&quot;Extra line plotting mode not found&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nl">main_label</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="n">axhell</span><span class="p">.</span><span class="n">set_leg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">axhell</span><span class="p">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="ss">&quot;best&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">fancybox</span><span class="o">=</span><span class="k">True</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">axhell</span><span class="p">.</span><span class="n">set_leg</span><span class="p">.</span><span class="n">get_frame</span><span class="p">().</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">plt</span><span class="p">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="k">pad</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span><span class="w"> </span><span class="n">w_pad</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="n">h_pad</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">plt</span><span class="p">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fig_name</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">plt</span><span class="p">.</span><span class="n">cla</span><span class="p">()</span><span class="w"></span>

<span class="w">    </span><span class="n">plt</span><span class="p">.</span><span class="k">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"></span>
</code></pre></div>


</details>
<h3 id="plot_err_bar_graphs">plot_err_bar_graphs</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">plot_err_bar_graphs</span><span class="p">(</span>
    <span class="n">graph_data_dic</span>
<span class="p">)</span>
</code></pre></div>


<p>Plot bar graphs with error bars.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="n">def</span><span class="w"> </span><span class="n">plot_err_bar_graphs</span><span class="p">(</span><span class="n">graph_data_dic</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">    </span><span class="ss">&quot;&quot;&quot;Plot bar graphs with error bars.&quot;&quot;&quot;</span><span class="w"></span>

<span class="w">    </span><span class="n">y_vals_keys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">&quot;median_li&quot;, &quot;mean_li&quot;</span><span class="o">]</span><span class="w"></span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">y_key</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">y_vals_keys</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="n">fig_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y_key</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="ss">&quot;.png&quot;</span><span class="w"></span>

<span class="w">        </span><span class="n">title_var</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y_key</span><span class="w"></span>

<span class="w">        </span><span class="n">y_vals</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">graph_data_dic</span><span class="o">[</span><span class="n">y_key</span><span class="o">]</span><span class="w"></span>

<span class="w">        </span><span class="n">x_pos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">list</span><span class="p">(</span><span class="k">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">y_vals</span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"></span>

<span class="w">        </span><span class="k">print</span><span class="p">(</span><span class="ss">&quot;\nCC&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">y_key</span><span class="p">,</span><span class="w"> </span><span class="n">y_vals</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">fig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">figure</span><span class="p">()</span><span class="w"></span>

<span class="w">        </span><span class="n">plt</span><span class="p">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="n">title_var</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">ax1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">plt</span><span class="p">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">ax1</span><span class="p">.</span><span class="n">grid</span><span class="p">(</span><span class="k">True</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">ax1</span><span class="p">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title_var</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">ax1</span><span class="p">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="ss">&quot;grey&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">ax1</span><span class="p">.</span><span class="n">bar</span><span class="p">(</span><span class="w"></span>

<span class="w">            </span><span class="n">x_pos</span><span class="p">,</span><span class="w"></span>

<span class="w">            </span><span class="n">y_vals</span><span class="p">,</span><span class="w"></span>

<span class="w">            </span><span class="n">width</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span><span class="w"></span>

<span class="w">            </span><span class="n">color</span><span class="o">=</span><span class="ss">&quot;g&quot;</span><span class="p">,</span><span class="w"></span>

<span class="w">            </span><span class="n">ecolor</span><span class="o">=</span><span class="ss">&quot;k&quot;</span><span class="p">,</span><span class="w"></span>

<span class="w">            </span><span class="n">yerr</span><span class="o">=</span><span class="n">graph_data_dic</span><span class="o">[</span><span class="n">&quot;stddev_li&quot;</span><span class="o">]</span><span class="p">,</span><span class="w"></span>

<span class="w">            </span><span class="n">tick_label</span><span class="o">=</span><span class="n">graph_data_dic</span><span class="o">[</span><span class="n">&quot;fn_li&quot;</span><span class="o">]</span><span class="p">,</span><span class="w"></span>

<span class="w">            </span><span class="n">capsize</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span><span class="w"></span>

<span class="w">            </span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.55</span><span class="p">,</span><span class="w"></span>

<span class="w">        </span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">ax1</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span><span class="w"> </span><span class="k">value</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">xxxxxxxxxxxxxx</span><span class="w"></span>

<span class="w">        </span><span class="n">plt</span><span class="p">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="k">pad</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span><span class="w"> </span><span class="n">w_pad</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="n">h_pad</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span><span class="w"></span>

<span class="w">        </span><span class="n">plt</span><span class="p">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fig_name</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">plt</span><span class="p">.</span><span class="n">cla</span><span class="p">()</span><span class="w"></span>

<span class="w">        </span><span class="n">plt</span><span class="p">.</span><span class="k">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span><span class="w"></span>
</code></pre></div>


</details>
<h3 id="split_list_on_missing_elem">split_list_on_missing_elem</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">split_list_on_missing_elem</span><span class="p">(</span>
    <span class="n">in_list</span>
<span class="p">)</span>
</code></pre></div>


<p>in: [1, 2, 3, 4, 6, 7, 8, 9, 10]
out: [[1, 2, 3, 4], [6, 7, 8, 9, 10]]
https://stackoverflow.com/questions/3149440/python-splitting-list-based-on-missing-numbers-in-a-sequence</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="n">def</span> <span class="n">split_list_on_missing_elem</span><span class="p">(</span><span class="n">in_list</span><span class="p">):</span>

    <span class="ss">&quot;&quot;&quot;</span>

<span class="ss">    in: [1, 2, 3, 4, 6, 7, 8, 9, 10]</span>

<span class="ss">    out: [[1, 2, 3, 4], [6, 7, 8, 9, 10]]</span>

<span class="ss">    https://stackoverflow.com/questions/3149440/python-splitting-list-based-on-missing-numbers-in-a-sequence</span>

<span class="ss">    &quot;&quot;&quot;</span>

    <span class="n">idx_holder</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="k">g</span> <span class="k">in</span> <span class="n">groupby</span><span class="p">(</span><span class="n">enumerate</span><span class="p">(</span><span class="n">in_list</span><span class="p">),</span> <span class="n">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>

        <span class="n">subli</span> <span class="o">=</span> <span class="n">list</span><span class="p">(</span><span class="k">map</span><span class="p">(</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="k">g</span><span class="p">))</span>

        <span class="n">idx_holder</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">subli</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">idx_holder</span>
</code></pre></div>


</details>
<h3 id="viz_anamoly_plot">viz_anamoly_plot</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">viz_anamoly_plot</span><span class="p">(</span>
    <span class="n">col_date</span><span class="p">,</span>
    <span class="n">residuals</span><span class="p">,</span>
    <span class="n">residual_mad</span><span class="p">,</span>
    <span class="n">norm_counts</span><span class="p">,</span>
    <span class="n">normc_median</span><span class="p">,</span>
    <span class="n">img_path</span><span class="p">,</span>
    <span class="n">myrigidity</span>
<span class="p">)</span>
</code></pre></div>


<p>Visualise the identified anomaly. Plots normalised counts and
euclidian distances with anomaly highlighted in red.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="n">def</span><span class="w"> </span><span class="n">viz_anamoly_plot</span><span class="p">(</span><span class="w"></span>

<span class="w">    </span><span class="n">col_date</span><span class="p">,</span><span class="w"> </span><span class="n">residuals</span><span class="p">,</span><span class="w"> </span><span class="n">residual_mad</span><span class="p">,</span><span class="w"> </span><span class="n">norm_counts</span><span class="p">,</span><span class="w"> </span><span class="n">normc_median</span><span class="p">,</span><span class="w"> </span><span class="n">img_path</span><span class="p">,</span><span class="w"> </span><span class="n">myrigidity</span><span class="w"></span>

<span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">    </span><span class="ss">&quot;&quot;&quot;Visualise the identified anomaly. Plots normalised counts and</span>

<span class="ss">       euclidian distances with anomaly highlighted in red.</span>

<span class="ss">    &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">indexes</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">anomalous</span><span class="w"> </span><span class="n">points</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="k">corresponding</span><span class="w"> </span><span class="n">y</span><span class="o">-</span><span class="n">axis</span><span class="w"> </span><span class="n">valuesA</span><span class="w"></span>

<span class="w">    </span><span class="n">anomalous_truth_mask</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">residuals</span><span class="o">[</span><span class="n">&quot;trig_anom&quot;</span><span class="o">]</span><span class="p">.</span><span class="n">tolist</span><span class="p">()</span><span class="w"></span>

<span class="w">    </span><span class="n">anomalous_times</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">residuals</span><span class="p">.</span><span class="k">index</span><span class="p">.</span><span class="n">tolist</span><span class="p">()</span><span class="w"></span>

<span class="w">    </span><span class="n">anomalous_nc_y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">norm_counts</span><span class="o">[</span><span class="n">col_date</span><span class="o">]</span><span class="p">.</span><span class="n">tolist</span><span class="p">()</span><span class="w"></span>

<span class="w">    </span><span class="n">anomalous_ncres_y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">residuals</span><span class="o">[</span><span class="n">col_date</span><span class="o">]</span><span class="p">.</span><span class="n">tolist</span><span class="p">()</span><span class="w"></span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="k">print</span><span class="p">(</span><span class="ss">&quot;\nanomalous_truth_mask:&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">anomalous_truth_mask</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="k">print</span><span class="p">(</span><span class="ss">&quot;\nanomalous_times:&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">anomalous_times</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="k">print</span><span class="p">(</span><span class="ss">&quot;\nanomalous_nc_y:&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">anomalous_nc_y</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="k">print</span><span class="p">(</span><span class="ss">&quot;\nanomalous_ncres_y:&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">anomalous_ncres_y</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="k">print</span><span class="p">(</span><span class="ss">&quot;\n&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">split</span><span class="w"> </span><span class="n">anomalus</span><span class="w"> </span><span class="n">lists</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="n">nested</span><span class="w"> </span><span class="n">lists</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">plot</span><span class="w"> </span><span class="n">properly</span><span class="w"></span>

<span class="w">    </span><span class="n">truth_idxes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">list_duplicates</span><span class="p">(</span><span class="n">anomalous_truth_mask</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">split_idxes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">split_list_on_missing_elem</span><span class="p">(</span><span class="n">truth_idxes</span><span class="o">[</span><span class="n">&quot;True&quot;</span><span class="o">]</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">plot</span><span class="w"> </span><span class="n">figure</span><span class="w"></span>

<span class="w">    </span><span class="n">figx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">figure</span><span class="p">()</span><span class="w"></span>

<span class="w">    </span><span class="n">ax1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">figx</span><span class="p">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">ax1</span><span class="p">.</span><span class="n">set_title</span><span class="p">(</span><span class="ss">&quot;Anomaly Standardised Counts&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">ax1</span><span class="p">.</span><span class="n">grid</span><span class="p">(</span><span class="k">True</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">ax1</span><span class="p">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.75</span><span class="p">,</span><span class="w"> </span><span class="mf">1.75</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">ax1</span><span class="p">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="ss">&quot;Norm counts&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">ax1</span><span class="p">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="ss">&quot;&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">ax1</span><span class="p">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="err">[]</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">sub_list</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">split_idxes</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="n">anom_time_sub</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">anomalous_times[idx</span><span class="o">]</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">idx</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">sub_list</span><span class="err">]</span><span class="w"></span>

<span class="w">        </span><span class="n">anom_ncy_sub</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">anomalous_nc_y[idx</span><span class="o">]</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">idx</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">sub_list</span><span class="err">]</span><span class="w"></span>

<span class="w">        </span><span class="n">ax1</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="w"></span>

<span class="w">            </span><span class="n">anom_time_sub</span><span class="p">,</span><span class="w"></span>

<span class="w">            </span><span class="n">anom_ncy_sub</span><span class="p">,</span><span class="w"></span>

<span class="w">            </span><span class="n">color</span><span class="o">=</span><span class="ss">&quot;orangered&quot;</span><span class="p">,</span><span class="w"></span>

<span class="w">            </span><span class="n">ls</span><span class="o">=</span><span class="ss">&quot;-&quot;</span><span class="p">,</span><span class="w"></span>

<span class="w">            </span><span class="n">lw</span><span class="o">=</span><span class="mf">4.4</span><span class="p">,</span><span class="w"></span>

<span class="w">            </span><span class="n">path_effects</span><span class="o">=[</span><span class="n">pe.Stroke(linewidth=4.6, foreground=&quot;black&quot;), pe.Normal()</span><span class="o">]</span><span class="p">,</span><span class="w"></span>

<span class="w">            </span><span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="w"></span>

<span class="w">        </span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">ax1</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="w"></span>

<span class="w">        </span><span class="n">residuals</span><span class="o">[</span><span class="n">col_date</span><span class="o">]</span><span class="p">.</span><span class="k">index</span><span class="p">,</span><span class="w"></span>

<span class="w">        </span><span class="n">norm_counts</span><span class="o">[</span><span class="n">col_date</span><span class="o">]</span><span class="p">,</span><span class="w"></span>

<span class="w">        </span><span class="n">color</span><span class="o">=</span><span class="ss">&quot;chartreuse&quot;</span><span class="p">,</span><span class="w"></span>

<span class="w">        </span><span class="n">ls</span><span class="o">=</span><span class="ss">&quot;-&quot;</span><span class="p">,</span><span class="w"></span>

<span class="w">        </span><span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span><span class="w"></span>

<span class="w">        </span><span class="n">path_effects</span><span class="o">=[</span><span class="n">pe.Stroke(linewidth=2.0, foreground=&quot;black&quot;), pe.Normal()</span><span class="o">]</span><span class="p">,</span><span class="w"></span>

<span class="w">        </span><span class="n">label</span><span class="o">=</span><span class="ss">&quot;Event&quot;</span><span class="p">,</span><span class="w"></span>

<span class="w">    </span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">ax1</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="w"></span>

<span class="w">        </span><span class="n">residuals</span><span class="o">[</span><span class="n">col_date</span><span class="o">]</span><span class="p">.</span><span class="k">index</span><span class="p">,</span><span class="w"></span>

<span class="w">        </span><span class="n">normc_median</span><span class="o">[</span><span class="n">&quot;median_of_cols&quot;</span><span class="o">]</span><span class="p">,</span><span class="w"></span>

<span class="w">        </span><span class="n">color</span><span class="o">=</span><span class="ss">&quot;dodgerblue&quot;</span><span class="p">,</span><span class="w"></span>

<span class="w">        </span><span class="n">ls</span><span class="o">=</span><span class="ss">&quot;--&quot;</span><span class="p">,</span><span class="w"></span>

<span class="w">        </span><span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span><span class="w"></span>

<span class="w">        </span><span class="n">label</span><span class="o">=</span><span class="ss">&quot;Median&quot;</span><span class="p">,</span><span class="w"></span>

<span class="w">    </span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">ax1</span><span class="p">.</span><span class="n">set_leg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ax1</span><span class="p">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="ss">&quot;best&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">fancybox</span><span class="o">=</span><span class="k">True</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">ax1</span><span class="p">.</span><span class="n">set_leg</span><span class="p">.</span><span class="n">get_frame</span><span class="p">().</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="err">###</span><span class="w"></span>

<span class="w">    </span><span class="n">ax2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">figx</span><span class="p">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">ax2</span><span class="p">.</span><span class="n">set_title</span><span class="p">(</span><span class="ss">&quot;Euclidian distances - myRig: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">str</span><span class="p">(</span><span class="n">myrigidity</span><span class="p">))</span><span class="w"></span>

<span class="w">    </span><span class="n">ax2</span><span class="p">.</span><span class="n">grid</span><span class="p">(</span><span class="k">True</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">ax2</span><span class="p">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span><span class="w"> </span><span class="mf">1.5</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">ax2</span><span class="p">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="ss">&quot;Norm Abs counts&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">ax2</span><span class="p">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="ss">&quot;Time&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">sub_list</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">split_idxes</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="n">anom_time_sub</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">anomalous_times[idx</span><span class="o">]</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">idx</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">sub_list</span><span class="err">]</span><span class="w"></span>

<span class="w">        </span><span class="n">anom_ncresy_sub</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">anomalous_ncres_y[idx</span><span class="o">]</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">idx</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">sub_list</span><span class="err">]</span><span class="w"></span>

<span class="w">        </span><span class="n">ax2</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="w"></span>

<span class="w">            </span><span class="n">anom_time_sub</span><span class="p">,</span><span class="w"></span>

<span class="w">            </span><span class="n">anom_ncresy_sub</span><span class="p">,</span><span class="w"></span>

<span class="w">            </span><span class="n">color</span><span class="o">=</span><span class="ss">&quot;orangered&quot;</span><span class="p">,</span><span class="w"></span>

<span class="w">            </span><span class="n">ls</span><span class="o">=</span><span class="ss">&quot;-&quot;</span><span class="p">,</span><span class="w"></span>

<span class="w">            </span><span class="n">lw</span><span class="o">=</span><span class="mf">4.4</span><span class="p">,</span><span class="w"></span>

<span class="w">            </span><span class="n">path_effects</span><span class="o">=[</span><span class="n">pe.Stroke(linewidth=4.6, foreground=&quot;black&quot;), pe.Normal()</span><span class="o">]</span><span class="p">,</span><span class="w"></span>

<span class="w">            </span><span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="w"></span>

<span class="w">        </span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">ax2</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="w"></span>

<span class="w">        </span><span class="n">residuals</span><span class="o">[</span><span class="n">col_date</span><span class="o">]</span><span class="p">.</span><span class="k">index</span><span class="p">,</span><span class="w"></span>

<span class="w">        </span><span class="n">residuals</span><span class="o">[</span><span class="n">col_date</span><span class="o">]</span><span class="p">,</span><span class="w"></span>

<span class="w">        </span><span class="n">color</span><span class="o">=</span><span class="ss">&quot;chartreuse&quot;</span><span class="p">,</span><span class="w"></span>

<span class="w">        </span><span class="n">ls</span><span class="o">=</span><span class="ss">&quot;-&quot;</span><span class="p">,</span><span class="w"></span>

<span class="w">        </span><span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span><span class="w"></span>

<span class="w">        </span><span class="n">path_effects</span><span class="o">=[</span><span class="n">pe.Stroke(linewidth=2.0, foreground=&quot;black&quot;), pe.Normal()</span><span class="o">]</span><span class="p">,</span><span class="w"></span>

<span class="w">        </span><span class="n">label</span><span class="o">=</span><span class="ss">&quot;Event residual&quot;</span><span class="p">,</span><span class="w"></span>

<span class="w">    </span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">ax2</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="w"></span>

<span class="w">        </span><span class="n">residuals</span><span class="o">[</span><span class="n">col_date</span><span class="o">]</span><span class="p">.</span><span class="k">index</span><span class="p">,</span><span class="w"></span>

<span class="w">        </span><span class="n">residual_mad</span><span class="o">[</span><span class="n">&quot;mad_of_myrig&quot;</span><span class="o">]</span><span class="p">,</span><span class="w"></span>

<span class="w">        </span><span class="n">color</span><span class="o">=</span><span class="ss">&quot;dodgerblue&quot;</span><span class="p">,</span><span class="w"></span>

<span class="w">        </span><span class="n">ls</span><span class="o">=</span><span class="ss">&quot;--&quot;</span><span class="p">,</span><span class="w"></span>

<span class="w">        </span><span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span><span class="w"></span>

<span class="w">        </span><span class="n">label</span><span class="o">=</span><span class="ss">&quot;Residual median&quot;</span><span class="p">,</span><span class="w"></span>

<span class="w">    </span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">ax2</span><span class="p">.</span><span class="n">set_leg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ax2</span><span class="p">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="ss">&quot;best&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">fancybox</span><span class="o">=</span><span class="k">True</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">ax2</span><span class="p">.</span><span class="n">set_leg</span><span class="p">.</span><span class="n">get_frame</span><span class="p">().</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">myax</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">figx</span><span class="p">.</span><span class="nl">axes</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="n">matplotlib</span><span class="p">.</span><span class="n">pyplot</span><span class="p">.</span><span class="n">sca</span><span class="p">(</span><span class="n">myax</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">plt</span><span class="p">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">plt</span><span class="p">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="k">pad</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span><span class="w"> </span><span class="n">w_pad</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="n">h_pad</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">plt</span><span class="p">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">img_path</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="ss">&quot;anomalies_&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">str</span><span class="p">(</span><span class="n">col_date</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="ss">&quot;.png&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">plt</span><span class="p">.</span><span class="n">cla</span><span class="p">()</span><span class="w"></span>

<span class="w">    </span><span class="n">plt</span><span class="p">.</span><span class="k">close</span><span class="p">(</span><span class="n">figx</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"></span>
</code></pre></div>


</details>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../string_tools/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../string_tools/" class="btn btn-xs btn-link">
        String Tools
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../os_functions/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../os_functions/" class="btn btn-xs btn-link">
        Os Functions
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content">
      <p>
        <a href="https://home-meatware/meatware/helpohelpo.git">helpohelpo</a>
      </p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://home-meatware/meatware/helpohelpo.git">Windmill Dark</a> theme by None (noraj).</p>
</footer>

</body>
</html>